// --- MODAL FUNCTIONS ---
function toggleModal() { document.getElementById("transactionModal").classList.toggle("hidden"); }
function toggleGoalModal() { document.getElementById("goalModal").classList.toggle("hidden"); }
function toggleSubModal() { document.getElementById("subModal").classList.toggle("hidden"); }
function closeRoast() { document.getElementById('roastModal').classList.add('hidden'); }

// --- ROAST FUNCTION ---
async function getRoast() {
    const modal = document.getElementById('roastModal');
    const text = document.getElementById('roastText');
    modal.classList.remove('hidden');
    text.innerText = "Consulting the Council of High Finance..."; 
    
    try {
        const response = await fetch('/roast_me');
        const data = await response.json();
        text.innerText = `"${data.roast}"`; 
    } catch (error) {
        console.error(error);
        text.innerText = "Even the AI is speechless at your spending.";
    }
}

// --- CHART INITIALIZER ---
// We create a function that accepts data as arguments
function initChart(labels, data) {
    const ctx = document.getElementById('expenseChart').getContext('2d');
    
    if (labels && labels.length > 0) {
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    data: data,
                    backgroundColor: ['#06b6d4', '#8b5cf6', '#ec4899', '#f59e0b', '#10b981', '#3b82f6'],
                    borderWidth: 0,
                    hoverOffset: 15
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '75%', 
                plugins: { 
                    legend: { 
                        position: 'bottom', 
                        labels: { 
                            color: '#94a3b8', 
                            font: { size: 10, family: 'Outfit' }, 
                            usePointStyle: true, 
                            boxWidth: 8 
                        } 
                    } 
                },
                animation: { animateScale: true, animateRotate: true }
            }
        });
    } else {
        ctx.font = "14px Outfit";
        ctx.fillStyle = "#64748b";
        ctx.textAlign = "center";
        ctx.fillText("No expenses logged", ctx.canvas.width/2, ctx.canvas.height/2);
    }
}

/* STRONGER NAVBAR GLASS */
.nav-glass {
    background: rgba(15, 23, 42, 0.95); 
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
}